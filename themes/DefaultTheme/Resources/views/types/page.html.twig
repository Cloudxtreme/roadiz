{% extends 'base.html.twig' %}

{% block header %}
	{% if nodeSource.headerImage|length > 0 %}
	{% set headerImage = nodeSource.headerImage[0] %}
	<header>
		<figure style="background-image:url({{ headerImage.viewer.documentUrlByArray(themeServices.imageFormats.headerImage) }})"></figure>
	</header>
	{% else %}
	{{ parent() }}
	{% endif %}
{% endblock %}

{% block content %}
{% spaceless %}
{% set breadcrumb = nodeSource.handler.parents %}
<div class="breadcrumb">
	{% for parent in breadcrumb|reverse %}
		{% if parent.id == home.id %}
		{% else %}
	    <a href="{{ parent.handler.url }}">{{ parent.title }}</a>
		{% endif %}
	{% endfor %}
</div>
{% endspaceless %}
<h1>{{ nodeSource.title }}</h1>
<h2>{{ nodeSource.subtitle }}</h2>


<div class="content">{{ nodeSource.content|markdown }}</div>
<div class="pictures">
	{% for document in nodeSource.pictures %}
		{% set imageMetas = document.documentTranslations.first %}
		<figure class="uk-thumbnail">
			{{ document.viewer.documentByArray(themeServices.imageFormats.thumbnail)|raw }}
			{% if imageMetas.name or imageMetas.copyright %}
			<figcaption>{{ imageMetas.name }} {{ imageMetas.copyright }}</figcaption>
			{% endif %}
		</figure>
	{% endfor %}
</div>

{% set prev = nodeSource.handler.previous(null,null,securityContext) %}
{% if not prev %}
{% set prev = nodeSource.handler.lastSibling(null,null,securityContext) %}
{% endif %}
{% set next = nodeSource.handler.next(null,null,securityContext) %}
{% if not next %}
{% set next = nodeSource.handler.firstSibling(null,null,securityContext) %}
{% endif %}
{% if not node.home and (prev or next) %}
{% spaceless %}
<nav class="contextual-menu">
	{% if prev %}
		<a class="previous" href="{{ prev.handler.url }}"><i class="uk-icon-arrow-left"></i> {{ prev.title }}</a>
	{% endif %}
	{% if next %}
		<a class="next" href="{{ next.handler.url }}">{{ next.title }} <i class="uk-icon-arrow-right"></i></a>
	{% endif %}
</nav>
{% endspaceless %}
{% endif %}
{% endblock %}
